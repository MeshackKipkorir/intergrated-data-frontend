<template>
    <div class="page">
        <div class="navbar navbar-transparent">
            <div class="navbar-bg"></div>
            <div class="navbar-inner sliding">
                <div class="left">
                    <a class="link back">
                        <i class="icon icon-back"></i>
                    </a>
                </div>
                <div class="title">Tenders</div>
                <div class="right">
                    <a href="#" class="panel-open link" data-panel=".sidebar-right">
                        <ion-icon name="filter-outline"></ion-icon><span></span>
                    </a>
                </div>
            </div>
        </div>
        <div class="page-content">
            <!-- sidebar / panel for filter -->
            <div class="panel-backdrop"></div>
            <div class="panel panel-right sidebar-right panel-cover panel-init">
                <div class="block-title title-small">
                    <h3>Sort by</h3>
                </div>
                <form class="list">
                    <ul>
                        <li class="item-content item-input">
                            <div class="item-inner">
                                <div class="item-input-wrap input-dropdown-wrap">
                                    <select id="filter">
                                        <option value="">Entity</option>
                                        <option value="Commissions and Independent Offices">Commissions and Independent Offices</option>
                                        <option value="County">County</option>
                                        <option value="State Corporation">State Corporation</option>
                                        <option value="County Assemblies">County Assemblies</option>
                                        <option value="Public Universities">Public Universities</option>
                                        <option value="Semi-Autonomous Government Agencies">Semi-Autonomous Government Agencies</option>
                                        <option value="Ministry">Ministry</option>
            
                                        <!-- <option value="Price">Price: Low to high</option>
									<option value="Price">Price: High to low</option> -->
                                    </select>
                                </div>
                            </div>
                        </li>
                    </ul>
                </form>
                <!-- <div class="block-title title-small">
                    <h3>Ratings</h3>
                </div>
                <div class="rating-filter">
                    <div class="container">
                        <ul>
                            <li class="rating-active"><a href="">
                                    <ion-icon name="star-sharp"></ion-icon>5
                                </a></li>
                            <li><a href="">
                                    <ion-icon name="star-sharp"></ion-icon>4
                                </a></li>
                            <li><a href="">
                                    <ion-icon name="star-sharp"></ion-icon>3
                                </a></li>
                            <li><a href="">
                                    <ion-icon name="star-sharp"></ion-icon>2
                                </a></li>
                            <li><a href="">
                                    <ion-icon name="star-sharp"></ion-icon>1
                                </a></li>
                        </ul>
                    </div>
                </div> -->
                <div class="block-title title-small">
                    <h3>Location</h3>
                </div>
                <form class="list">
                    <ul>
                        <li class="item-content item-input">
                            <div class="item-inner">
                                <div class="item-input-wrap">
                                    <input type="text" placeholder="Current location">
                                    <span class="input-clear-button"></span>
                                </div>
                            </div>
                        </li>
                    </ul>
                </form>
                <!-- <div class="block-title title-small">
                    <h3>Price Range</h3>
                </div>
                <div class="container">
                    <form class="list">
                        <ul>
                            <li>
                                <div class="row">
                                    <div class="col-50">
                                        <div class="item-content item-input">
                                            <div class="item-inner">
                                                <div class="item-input-wrap">
                                                    <input type="text" placeholder="Minimum">
                                                    <span class="input-clear-button"></span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-50">
                                        <div class="item-content item-input">
                                            <div class="item-inner">
                                                <div class="item-input-wrap">
                                                    <input type="text" placeholder="Maximum">
                                                    <span class="input-clear-button"></span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </form>
                </div> -->
                <!-- separator -->
                <div class="separator-large"></div>
                <!-- end separator -->
                <div class="fitler-execution">
                    <div class="container">
                        <button class="button secondary-button panel-close">Cancel</button>
                        <!-- separator -->
                        <div class="separator-medium"></div>
                        <!-- end separator -->
                        <button class="button" @click="applyFilter">Apply Filters</button>
                    </div>
                </div>
                <!-- separator -->
                <div class="separator-large"></div>
                <!-- end separator -->
            </div>
            <!-- end sidebar / panel for filter -->
            <!-- separator -->
            <div class="separator-extra-small"></div>
            <!-- end separator -->
            <!-- header searchbar -->
            <div class="header-searchbar">
                <form class="searchbar">
                    <div class="searchbar-inner">
                        <div class="searchbar-input-wrap">
                            <input type="search" placeholder="Find tenders, jobs & government news">
                            <i class="searchbar-icon"></i>
                            <span class="input-clear-button"></span>
                        </div>
                        <span class="searchbar-disable-button">Cancel</span>
                    </div>
                </form>
            </div>
            <!-- end header searchbar -->
            <!-- separator -->
            <div class="separator-small"></div>
            <!-- end separator -->
            <!-- all categories -->
            <div class="categories">
                <div class="container">

                    <!--
                    <div class="row">
                    	{{#each data.data}}
                        <div class="col-50">
                            <div class="content-item radius-default bg-white">
                                <a href="" data-transition="f7-dive">
                                    <div class="favorite-symbol">
                                        <ion-icon name="heart-outline"></ion-icon>
                                    </div>
                                </a>
                                <a href="/single-tender/{{this.id}}">
                                    <img class="full-width radius-top-only" src="images/tenders/download.jpeg" alt="">
                                    <div class="text-desc">
                                        <p class="title-item">{{this.tender_title}}</p>
                                        <p class="price-item">{{this.tender_code}}</p>
                                        <p class="location-item">
                                            <ion-icon name="map-outline"></ion-icon>{{this.org_name}}
                                        </p>
                                    </div>
                                </a>
                            </div>
                        </div>  
                        {{/each}}
                    </div>-->
                    <div class="row">
                        {{#each data}}
                        <div class="col-50">
                            <div class="content-item radius-default bg-white">
                                <a href="" data-transition="f7-dive">
                                    <div class="favorite-symbol" @click="addFavourite('{{this.tender_title}}'"><ion-icon name="heart-outline"></ion-icon></div>
                                </a>
                                <a href="/single-tender/{{this.id}}/{{this.image}}">
                                    <img class="full-width radius-top-only" src="images/{{this.image}}" alt="" height="100" width="100">
                                    <div class="text-desc">
                                        <p class="price-item">{{this.tender_title}}</p>
                                        <p class="location-item"><ion-icon name="map-outline"></ion-icon>{{this.posted_at}}</p>
                                        <p class="title-item">{{this.org_name}}</p>
                                    </div>
                                </a>
                            </div>
                        </div>
                        {{/each}}
                    </div>
            </div>
            <!-- end all categories -->
            <!-- separator -->
            <div class="separator-large"></div>
            <!-- end separator -->
        </div>
    </div>
</template>
<script>
// script must return component object
console.log('logged in as '+sessionStorage.getItem('user'));
return {
    methods: {
    addFavourite: function (title,job_id) {
      var userEmail = sessionStorage.getItem('user');
      console.log(title);
      console.log(job_id);
      
      if(sessionStorage.getItem('user') != null){
      app.request.post('http://localhost:8000/api/insertTenderNotification?email='+userEmail+'&title='+title+'&tender_id=3'+'&closing_date=29-10-2020', function (data,response) {
		console.log(response);

		var obj = data; 
        // console.log(obj);
        // console.log(obj.success);

        if (response == 200) {
          console.log('fav added successfully');
          app.dialog.alert('Added to Your Tenders' , function () {});     
        } else {
			app.dialog.alert(obj.Message , function () {});

        }
      });
    }
    else{
        app.dialog.alert('please login!');
        app.views.main.router.navigate('/sign-in/');
    }
    },
    applyFilter: function(){
        app.preloader.show();

        var filter = $('#filter').val();
        console.log(filter);
        app.views.main.router.navigate('/filtered-jobs/'+filter+'/');   

    }
  },
    data: function() {
    
    },

    on: {
        pageInit: function(e, page) {
            console.log('');
        }
    }
}
</script>