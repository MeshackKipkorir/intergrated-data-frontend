<template>
    <div class="page">
        <div class="navbar navbar-transparent">
            <div class="navbar-bg"></div>
            <div class="navbar-inner sliding">
                <div class="left">
                    <a class="link back">
                        <i class="icon icon-back"></i>
                    </a>
                </div>
                <div class="title">Jobs</div>
                <div class="right">
                    <a href="#" class="panel-open link" data-panel=".sidebar-right">
                        <ion-icon name="filter-outline"></ion-icon><span></span>
                    </a>
                </div>
            </div>
        </div>
        <div class="page-content">
            <!-- sidebar / panel for filter -->
            <div class="panel-backdrop"></div>
            <div class="panel panel-right sidebar-right panel-cover panel-init">
                <div class="block-title title-small">
                    <h3>Sort by</h3>
                </div>
                <form class="list">
                    <ul>
                        <li class="item-content item-input">
                            <div class="item-inner">
                                <div class="item-input-wrap input-dropdown-wrap">
                                    <select id="filter">
                                        <option value="">Department</option>
                                        <option value="Technical Education">Technical Education</option>
                                        <option value="State Department of Livestock">State Department of Livestock</option>
                                        <option value="Department of Defence">Department of Defence</option>
                                        <option value="State Department for Devolution">State Department for Devolution</option>
                                        <option value="State Department for ASALs">State Department for ASALs</option>
                                        <option value="East African Community">East African Community</option>
                                        <option value="State Department for Petroleum">State Department for Petroleum</option>
                                        <option value="Foreign Services">Foreign Services</option>
                                        <option value="State Department of Coordination of National Government">State Department of Coordination of National Government</option>
                                        <option value="State Department of Tourism">State Department of Tourism</option>
                                        <option value="State of Department of Wildlife">State of Department of Wildlife</option>
                                        <option value="State Department of Infrastructure">State Department of Infrastructure</option>
                                        <option value="State Department for Youth Affairs">State Department for Youth Affairs</option>
                                        <!-- <option value="Price">Price: Low to high</option>
									<option value="Price">Price: High to low</option> -->
                                    </select>
                                </div>
                            </div>
                        </li>
                    </ul>
                </form>
                <!-- ratings -->
                <!-- <div class="block-title title-small">
                    <h3>Ratings</h3>
                </div>
                <div class="rating-filter">
                    <div class="container">
                        <ul>
                            <li class="rating-active"><a href="">
                                    <ion-icon name="star-sharp"></ion-icon>5
                                </a></li>
                            <li><a href="">
                                    <ion-icon name="star-sharp"></ion-icon>4
                                </a></li>
                            <li><a href="">
                                    <ion-icon name="star-sharp"></ion-icon>3
                                </a></li>
                            <li><a href="">
                                    <ion-icon name="star-sharp"></ion-icon>2
                                </a></li>
                            <li><a href="">
                                    <ion-icon name="star-sharp"></ion-icon>1
                                </a></li>
                        </ul>
                    </div>
                </div> -->
                <div class="block-title title-small">
                    <h3>Location</h3>
                </div>
                <form class="list">
                    <ul>
                        <li class="item-content item-input">
                            <div class="item-inner">
                                <div class="item-input-wrap">
                                    <input type="text" placeholder="Current location">
                                    <span class="input-clear-button"></span>
                                </div>
                            </div>
                        </li>
                    </ul>
                </form>
                <!-- <div class="block-title title-small">
                    <h3>Price Range</h3>
                </div>
                <div class="container">
                    <form class="list">
                        <ul>
                            <li>
                                <div class="row">
                                    <div class="col-50">
                                        <div class="item-content item-input">
                                            <div class="item-inner">
                                                <div class="item-input-wrap">
                                                    <input type="text" placeholder="Minimum">
                                                    <span class="input-clear-button"></span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-50">
                                        <div class="item-content item-input">
                                            <div class="item-inner">
                                                <div class="item-input-wrap">
                                                    <input type="text" placeholder="Maximum">
                                                    <span class="input-clear-button"></span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </form>
                </div> -->
                <!-- separator -->
                <div class="separator-large"></div>
                <!-- end separator -->
                <div class="fitler-execution">
                    <div class="container">
                        <button class="button secondary-button panel-close">Cancel</button>
                        <!-- separator -->
                        <div class="separator-medium"></div>
                        <!-- end separator -->
                        <a data-transition="f7-dive" class="button item-link item-content panel-close"  @click="applyFilter">Apply Filters</a>
                    </div>
                </div>
                <!-- separator -->
                <div class="separator-large"></div>
                <!-- end separator -->
            </div>
            <!-- end sidebar / panel for filter -->
            <!-- separator -->
            <div class="separator-extra-small"></div>
            <!-- end separator -->
            <!-- header searchbar -->
            <div class="header-searchbar">
                <form class="searchbar">
                    <div class="searchbar-inner">
                        <div class="searchbar-input-wrap">
                            <input type="search" placeholder="Find tenders, jobs & government news">
                            <i class="searchbar-icon"></i>
                            <span class="input-clear-button"></span>
                        </div>
                        <span class="searchbar-disable-button">Cancel</span>
                    </div>
                </form>
            </div>
            <!-- end header searchbar -->
            <!-- separator -->
            <div class="separator-small"></div>
            <!-- end separator -->
            <!-- all categories -->
            <div class="categories">
                <div class="container">
                   
                    <div class="row">
                        {{#each data.data}}
                        <div class="col-50">
                            <div class="content-item radius-default bg-white">
                                <a href="" data-transition="f7-dive">
                                    <div class="favorite-symbol" id="{{this.id}}" @click="addFavourite('{{this.post}}')">
                                        <ion-icon name="heart-outline"></ion-icon>
                                    </div>
                                </a>
                                <a href="/single-job/{{this.id}}">
                                    <img class="full-width radius-top-only" src="images/jobs/jobs.jpg" alt="">
                                    <div class="text-desc">
                                        <p class="title-item">{{this.post}}</p>
                                        <p class="price-item">{{this.advert_no}}</p>
                                        <p class="location-item">
                                            <ion-icon name="map-outline"></ion-icon>{{this.department}}
                                        </p>
                                    </div>
                                </a>
                            </div>
                        </div>
                        
                        {{/each}}
                    </div>
                

<!--
                <div class="row">
                    <div class="col-50">
                        <div class="content-item radius-default bg-white">
                            <a href="" data-transition="f7-dive">
                                <div class="favorite-symbol" @click="addFavourite"><ion-icon name="heart-outline"></ion-icon></div>
                            </a>
                            <a href="/single-job/2/tvet.png">
                                <img class="full-width radius-top-only" src="images/jobs/TVETA.png" alt="" height="100" width="100">
                                <div class="text-desc">
                                    <p class="price-item">Assistant Director , Vocational Education and Training...</p>
                                    <p class="location-item"><ion-icon name="map-outline"></ion-icon>September 29 ,2020</p>
                                    <p class="title-item">Technical Edication</p>
                                </div>
                            </a>
                        </div>
                    </div>
                  
                        <div class="col-50">
                        <div class="content-item radius-default bg-white">
                            <a href="" data-transition="f7-dive">
                                <div class="favorite-symbol"><ion-icon name="heart-outline"></ion-icon></div>
                            </a>
                            <a href="/single-job/13/DOD.png">
                                <img class="full-width radius-top-only" src="images/jobs/DOD.png " alt="" height="100" width="100">
                                <div class="text-desc">
                                    <p class="price-item">BIO-Medical Engineer(National Government)</p>
                                    <p class="location-item"><ion-icon name="map-outline"></ion-icon>September 29 ,2020</p>
                                    <p class="title-item">Department of Defense</p>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-50">
                        <div class="content-item radius-default bg-white">
                            <a href="" data-transition="f7-dive">
                                <div class="favorite-symbol"><ion-icon name="heart-outline"></ion-icon></div>
                            </a>
                            <a href="/single-job/23/devolution.png">
                                <img class="full-width radius-top-only" src="images/jobs/tourism.jpeg" alt="" height="100" width="100">
                                <div class="text-desc">
                                    <p class="price-item"> Secretary - Devolution</p>
                                    <p class="location-item"><ion-icon name="map-outline"></ion-icon>September 29 ,2020</p>
                                    <p class="title-item">State Department of Devolution</p>
                                </div>
                            </a>
                        </div>
                    </div>
                  
                        <div class="col-50">
                        <div class="content-item radius-default bg-white">
                            <a href="" data-transition="f7-dive">
                                <div class="favorite-symbol"><ion-icon name="heart-outline"></ion-icon></div>
                            </a>
                            <a href="/single-job/27/eac.png">
                                <img class="full-width radius-top-only" src="images/jobs/eac.png" alt="" height="100" width="100">
                                <div class="text-desc">
                                    <p class="price-item">Director- Regulatory, Communication and Field Services</p>
                                    <p class="location-item"><ion-icon name="map-outline"></ion-icon>September 29 ,2020</p>
                                    <p class="title-item">East African Community</p>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-50">
                        <div class="content-item radius-default bg-white">
                            <a href="" data-transition="f7-dive">
                                <div class="favorite-symbol"><ion-icon name="heart-outline"></ion-icon></div>
                            </a>
                            <a href="/single-job/42/petroleum.jpeg">
                                <img class="full-width radius-top-only" src="images/jobs/petroleum.jpeg" alt="" height="100" width="100">
                                <div class="text-desc">
                                    <p class="price-item">Petroleum Energy </p>
                                    <p class="location-item"><ion-icon name="map-outline"></ion-icon>September 29 ,2020</p>
                                    <p class="title-item">Chief Superintedning GeoPhysicist</p>
                                </div>
                            </a>
                        </div>
                    </div>
                  
                        <div class="col-50">
                        <div class="content-item radius-default bg-white">
                            <a href="" data-transition="f7-dive">
                                <div class="favorite-symbol"><ion-icon name="heart-outline"></ion-icon></div>
                            </a>
                            <a href="/single-job/44/climate.jpeg">
                                <img class="full-width radius-top-only" src="images/jobs/climate.jpeg" alt="" height="100" width="100">
                                <div class="text-desc">
                                    <p class="price-item">Deputy Director-Climate Change Adaptation</p>
                                    <p class="location-item"><ion-icon name="map-outline"></ion-icon>September 29 ,2020</p>
                                    <p class="title-item">Climate change enabling activities</p>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-50">
                        <div class="content-item radius-default bg-white">
                            <a href="" data-transition="f7-dive">
                                <div class="favorite-symbol"><ion-icon name="heart-outline"></ion-icon></div>
                            </a>
                            <a href="/single-job/70/tourism.jpeg">
                                <img class="full-width radius-top-only" src="images/jobs/tourism.jpeg" alt="" height="100" width="100">
                                <div class="text-desc">
                                    <p class="price-item">Deputy Director - Tourism Development & Promotion</p>
                                    <p class="location-item"><ion-icon name="map-outline"></ion-icon>September 29 ,2020</p>
                                    <p class="title-item">State Department of Tourism</p>
                                </div>
                            </a>
                        </div>
                    </div>
                  
                        <div class="col-50">
                        <div class="content-item radius-default bg-white">
                            <a href="" data-transition="f7-dive">
                                <div class="favorite-symbol"><ion-icon name="heart-outline"></ion-icon></div>
                            </a>
                            <a href="/single-job/77/tourism.jpeg">
                                <img class="full-width radius-top-only" src="images/jobs/tourism.jpeg" alt="" height="100" width="100">
                                <div class="text-desc">
                                    <p class="price-item">Deputy Director - Wildlife, Research Policy & Innovation</p>
                                    <p class="location-item"><ion-icon name="map-outline"></ion-icon>September 29 ,2020</p>
                                    <p class="title-item">State of Department of Wildlife</p>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>
            -->
                </div>
            </div>
            <!-- end all categories -->
            <!-- separator -->
            <div class="separator-large"></div>
            <!-- end separator -->
        </div>
    </div>
</template>
<script>
// script must return component object
console.log('logged in as '+sessionStorage.getItem('user'));
console.log(sessionStorage.getItem('user') == null);
return {
    methods: {
    addFavourite: function (title,job_id) {
      var userEmail = sessionStorage.getItem('user');
      console.log(title);
      console.log(job_id);
      job_id = 3;
      //change symbol to active
      $('.favorite-symbol').addClass('active-symbol');  
      if(sessionStorage.getItem('user') != null){
      app.request.post('http://localhost:8000/api/insertNotification?email='+userEmail+'&title='+title+'&job_id=3'+'&closing_date=9-10-2020', function (data,response) {
		console.log(response);

		var obj = data; 
        // console.log(obj);
        // console.log(obj.success);

        if (response == 200) {
          console.log('fav added successfully');
          app.dialog.alert('Added to favourites' , function () {});     
        } else {
			app.dialog.alert(obj.Message , function () {});

        }
      });
    }
    else{
        app.dialog.alert('please login!');
        app.views.main.router.navigate('/sign-in/');
    }
    },
    applyFilter: function(){
        app.preloader.show();

        var filter = $('#filter').val();
        console.log(filter);
        app.views.main.router.navigate('/filtered-jobs/'+filter+'/');   

    }
  },
    data: function() {
        console.log(JSON.parse(jobsJson.response));
        return {
            data: JSON.parse(jobsJson.response),
        }
    },

    on: {
        pageInit: function(e, page) {
            console.log('');
        }
    }
}
</script>